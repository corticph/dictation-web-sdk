function d(i,e,t,r){var o=arguments.length,n=o<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(i,e,t,r);else for(var c=i.length-1;c>=0;c--)(s=i[c])&&(n=(o<3?s(n):o>3?s(e,t,n):s(e,t))||n);return o>3&&n&&Object.defineProperty(e,t,n),n}var z=globalThis,B=z.ShadowRoot&&(z.ShadyCSS===void 0||z.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,Y=Symbol(),ue=new WeakMap,R=class{constructor(e,t,r){if(this._$cssResult$=!0,r!==Y)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o,t=this.t;if(B&&e===void 0){let r=t!==void 0&&t.length===1;r&&(e=ue.get(t)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),r&&ue.set(t,e))}return e}toString(){return this.cssText}},pe=i=>new R(typeof i=="string"?i:i+"",void 0,Y),g=(i,...e)=>{let t=i.length===1?i[0]:e.reduce((r,o,n)=>r+(s=>{if(s._$cssResult$===!0)return s.cssText;if(typeof s=="number")return s;throw Error("Value passed to 'css' function must be a 'css' function result: "+s+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(o)+i[n+1],i[0]);return new R(t,i,Y)},ee=(i,e)=>{if(B)i.adoptedStyleSheets=e.map(t=>t instanceof CSSStyleSheet?t:t.styleSheet);else for(let t of e){let r=document.createElement("style"),o=z.litNonce;o!==void 0&&r.setAttribute("nonce",o),r.textContent=t.cssText,i.appendChild(r)}},q=B?i=>i:i=>i instanceof CSSStyleSheet?(e=>{let t="";for(let r of e.cssRules)t+=r.cssText;return pe(t)})(i):i;var{is:Ie,defineProperty:Ne,getOwnPropertyDescriptor:He,getOwnPropertyNames:ze,getOwnPropertySymbols:Be,getPrototypeOf:qe}=Object,V=globalThis,he=V.trustedTypes,Ve=he?he.emptyScript:"",Fe=V.reactiveElementPolyfillSupport,D=(i,e)=>i,T={toAttribute(i,e){switch(e){case Boolean:i=i?Ve:null;break;case Object:case Array:i=i==null?i:JSON.stringify(i)}return i},fromAttribute(i,e){let t=i;switch(e){case Boolean:t=i!==null;break;case Number:t=i===null?null:Number(i);break;case Object:case Array:try{t=JSON.parse(i)}catch{t=null}}return t}},F=(i,e)=>!Ie(i,e),fe={attribute:!0,type:String,converter:T,reflect:!1,hasChanged:F};Symbol.metadata??=Symbol("metadata"),V.litPropertyMetadata??=new WeakMap;var _=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??=[]).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,t=fe){if(t.state&&(t.attribute=!1),this._$Ei(),this.elementProperties.set(e,t),!t.noAccessor){let r=Symbol(),o=this.getPropertyDescriptor(e,r,t);o!==void 0&&Ne(this.prototype,e,o)}}static getPropertyDescriptor(e,t,r){let{get:o,set:n}=He(this.prototype,e)??{get(){return this[t]},set(s){this[t]=s}};return{get(){return o?.call(this)},set(s){let c=o?.call(this);n.call(this,s),this.requestUpdate(e,c,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??fe}static _$Ei(){if(this.hasOwnProperty(D("elementProperties")))return;let e=qe(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(D("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(D("properties"))){let t=this.properties,r=[...ze(t),...Be(t)];for(let o of r)this.createProperty(o,t[o])}let e=this[Symbol.metadata];if(e!==null){let t=litPropertyMetadata.get(e);if(t!==void 0)for(let[r,o]of t)this.elementProperties.set(r,o)}this._$Eh=new Map;for(let[t,r]of this.elementProperties){let o=this._$Eu(t,r);o!==void 0&&this._$Eh.set(o,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){let t=[];if(Array.isArray(e)){let r=new Set(e.flat(1/0).reverse());for(let o of r)t.unshift(q(o))}else e!==void 0&&t.push(q(e));return t}static _$Eu(e,t){let r=t.attribute;return r===!1?void 0:typeof r=="string"?r:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise(e=>this.enableUpdating=e),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach(e=>e(this))}addController(e){(this._$EO??=new Set).add(e),this.renderRoot!==void 0&&this.isConnected&&e.hostConnected?.()}removeController(e){this._$EO?.delete(e)}_$E_(){let e=new Map,t=this.constructor.elementProperties;for(let r of t.keys())this.hasOwnProperty(r)&&(e.set(r,this[r]),delete this[r]);e.size>0&&(this._$Ep=e)}createRenderRoot(){let e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return ee(e,this.constructor.elementStyles),e}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach(e=>e.hostConnected?.())}enableUpdating(e){}disconnectedCallback(){this._$EO?.forEach(e=>e.hostDisconnected?.())}attributeChangedCallback(e,t,r){this._$AK(e,r)}_$EC(e,t){let r=this.constructor.elementProperties.get(e),o=this.constructor._$Eu(e,r);if(o!==void 0&&r.reflect===!0){let n=(r.converter?.toAttribute!==void 0?r.converter:T).toAttribute(t,r.type);this._$Em=e,n==null?this.removeAttribute(o):this.setAttribute(o,n),this._$Em=null}}_$AK(e,t){let r=this.constructor,o=r._$Eh.get(e);if(o!==void 0&&this._$Em!==o){let n=r.getPropertyOptions(o),s=typeof n.converter=="function"?{fromAttribute:n.converter}:n.converter?.fromAttribute!==void 0?n.converter:T;this._$Em=o,this[o]=s.fromAttribute(t,n.type),this._$Em=null}}requestUpdate(e,t,r){if(e!==void 0){if(r??=this.constructor.getPropertyOptions(e),!(r.hasChanged??F)(this[e],t))return;this.P(e,t,r)}this.isUpdatePending===!1&&(this._$ES=this._$ET())}P(e,t,r){this._$AL.has(e)||this._$AL.set(e,t),r.reflect===!0&&this._$Em!==e&&(this._$Ej??=new Set).add(e)}async _$ET(){this.isUpdatePending=!0;try{await this._$ES}catch(t){Promise.reject(t)}let e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(let[o,n]of this._$Ep)this[o]=n;this._$Ep=void 0}let r=this.constructor.elementProperties;if(r.size>0)for(let[o,n]of r)n.wrapped!==!0||this._$AL.has(o)||this[o]===void 0||this.P(o,this[o],n)}let e=!1,t=this._$AL;try{e=this.shouldUpdate(t),e?(this.willUpdate(t),this._$EO?.forEach(r=>r.hostUpdate?.()),this.update(t)):this._$EU()}catch(r){throw e=!1,this._$EU(),r}e&&this._$AE(t)}willUpdate(e){}_$AE(e){this._$EO?.forEach(t=>t.hostUpdated?.()),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EU(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Ej&&=this._$Ej.forEach(t=>this._$EC(t,this[t])),this._$EU()}updated(e){}firstUpdated(e){}};_.elementStyles=[],_.shadowRootOptions={mode:"open"},_[D("elementProperties")]=new Map,_[D("finalized")]=new Map,Fe?.({ReactiveElement:_}),(V.reactiveElementVersions??=[]).push("2.0.4");var ae=globalThis,W=ae.trustedTypes,ge=W?W.createPolicy("lit-html",{createHTML:i=>i}):void 0,xe="$lit$",$=`lit$${Math.random().toFixed(9).slice(2)}$`,we="?"+$,We=`<${we}>`,E=document,M=()=>E.createComment(""),U=i=>i===null||typeof i!="object"&&typeof i!="function",ce=Array.isArray,Ge=i=>ce(i)||typeof i?.[Symbol.iterator]=="function",te=`[ 	
\f\r]`,j=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,me=/-->/g,ve=/>/g,S=RegExp(`>|${te}(?:([^\\s"'>=/]+)(${te}*=${te}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),ye=/'/g,be=/"/g,$e=/^(?:script|style|textarea|title)$/i,le=i=>(e,...t)=>({_$litType$:i,strings:e,values:t}),u=le(1),dt=le(2),ut=le(3),C=Symbol.for("lit-noChange"),f=Symbol.for("lit-nothing"),_e=new WeakMap,A=E.createTreeWalker(E,129);function Se(i,e){if(!ce(i)||!i.hasOwnProperty("raw"))throw Error("invalid template strings array");return ge!==void 0?ge.createHTML(e):e}var Ke=(i,e)=>{let t=i.length-1,r=[],o,n=e===2?"<svg>":e===3?"<math>":"",s=j;for(let c=0;c<t;c++){let a=i[c],h,m,l=-1,b=0;for(;b<a.length&&(s.lastIndex=b,m=s.exec(a),m!==null);)b=s.lastIndex,s===j?m[1]==="!--"?s=me:m[1]!==void 0?s=ve:m[2]!==void 0?($e.test(m[2])&&(o=RegExp("</"+m[2],"g")),s=S):m[3]!==void 0&&(s=S):s===S?m[0]===">"?(s=o??j,l=-1):m[1]===void 0?l=-2:(l=s.lastIndex-m[2].length,h=m[1],s=m[3]===void 0?S:m[3]==='"'?be:ye):s===be||s===ye?s=S:s===me||s===ve?s=j:(s=S,o=void 0);let w=s===S&&i[c+1].startsWith("/>")?" ":"";n+=s===j?a+We:l>=0?(r.push(h),a.slice(0,l)+xe+a.slice(l)+$+w):a+$+(l===-2?c:w)}return[Se(i,n+(i[t]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),r]},L=class i{constructor({strings:e,_$litType$:t},r){let o;this.parts=[];let n=0,s=0,c=e.length-1,a=this.parts,[h,m]=Ke(e,t);if(this.el=i.createElement(h,r),A.currentNode=this.el.content,t===2||t===3){let l=this.el.content.firstChild;l.replaceWith(...l.childNodes)}for(;(o=A.nextNode())!==null&&a.length<c;){if(o.nodeType===1){if(o.hasAttributes())for(let l of o.getAttributeNames())if(l.endsWith(xe)){let b=m[s++],w=o.getAttribute(l).split($),H=/([.?@])?(.*)/.exec(b);a.push({type:1,index:n,name:H[2],strings:w,ctor:H[1]==="."?oe:H[1]==="?"?ie:H[1]==="@"?ne:P}),o.removeAttribute(l)}else l.startsWith($)&&(a.push({type:6,index:n}),o.removeAttribute(l));if($e.test(o.tagName)){let l=o.textContent.split($),b=l.length-1;if(b>0){o.textContent=W?W.emptyScript:"";for(let w=0;w<b;w++)o.append(l[w],M()),A.nextNode(),a.push({type:2,index:++n});o.append(l[b],M())}}}else if(o.nodeType===8)if(o.data===we)a.push({type:2,index:n});else{let l=-1;for(;(l=o.data.indexOf($,l+1))!==-1;)a.push({type:7,index:n}),l+=$.length-1}n++}}static createElement(e,t){let r=E.createElement("template");return r.innerHTML=e,r}};function O(i,e,t=i,r){if(e===C)return e;let o=r!==void 0?t._$Co?.[r]:t._$Cl,n=U(e)?void 0:e._$litDirective$;return o?.constructor!==n&&(o?._$AO?.(!1),n===void 0?o=void 0:(o=new n(i),o._$AT(i,t,r)),r!==void 0?(t._$Co??=[])[r]=o:t._$Cl=o),o!==void 0&&(e=O(i,o._$AS(i,e.values),o,r)),e}var re=class{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){let{el:{content:t},parts:r}=this._$AD,o=(e?.creationScope??E).importNode(t,!0);A.currentNode=o;let n=A.nextNode(),s=0,c=0,a=r[0];for(;a!==void 0;){if(s===a.index){let h;a.type===2?h=new I(n,n.nextSibling,this,e):a.type===1?h=new a.ctor(n,a.name,a.strings,this,e):a.type===6&&(h=new se(n,this,e)),this._$AV.push(h),a=r[++c]}s!==a?.index&&(n=A.nextNode(),s++)}return A.currentNode=E,o}p(e){let t=0;for(let r of this._$AV)r!==void 0&&(r.strings!==void 0?(r._$AI(e,r,t),t+=r.strings.length-2):r._$AI(e[t])),t++}},I=class i{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(e,t,r,o){this.type=2,this._$AH=f,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=r,this.options=o,this._$Cv=o?.isConnected??!0}get parentNode(){let e=this._$AA.parentNode,t=this._$AM;return t!==void 0&&e?.nodeType===11&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=O(this,e,t),U(e)?e===f||e==null||e===""?(this._$AH!==f&&this._$AR(),this._$AH=f):e!==this._$AH&&e!==C&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):Ge(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==f&&U(this._$AH)?this._$AA.nextSibling.data=e:this.T(E.createTextNode(e)),this._$AH=e}$(e){let{values:t,_$litType$:r}=e,o=typeof r=="number"?this._$AC(e):(r.el===void 0&&(r.el=L.createElement(Se(r.h,r.h[0]),this.options)),r);if(this._$AH?._$AD===o)this._$AH.p(t);else{let n=new re(o,this),s=n.u(this.options);n.p(t),this.T(s),this._$AH=n}}_$AC(e){let t=_e.get(e.strings);return t===void 0&&_e.set(e.strings,t=new L(e)),t}k(e){ce(this._$AH)||(this._$AH=[],this._$AR());let t=this._$AH,r,o=0;for(let n of e)o===t.length?t.push(r=new i(this.O(M()),this.O(M()),this,this.options)):r=t[o],r._$AI(n),o++;o<t.length&&(this._$AR(r&&r._$AB.nextSibling,o),t.length=o)}_$AR(e=this._$AA.nextSibling,t){for(this._$AP?.(!1,!0,t);e&&e!==this._$AB;){let r=e.nextSibling;e.remove(),e=r}}setConnected(e){this._$AM===void 0&&(this._$Cv=e,this._$AP?.(e))}},P=class{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,r,o,n){this.type=1,this._$AH=f,this._$AN=void 0,this.element=e,this.name=t,this._$AM=o,this.options=n,r.length>2||r[0]!==""||r[1]!==""?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=f}_$AI(e,t=this,r,o){let n=this.strings,s=!1;if(n===void 0)e=O(this,e,t,0),s=!U(e)||e!==this._$AH&&e!==C,s&&(this._$AH=e);else{let c=e,a,h;for(e=n[0],a=0;a<n.length-1;a++)h=O(this,c[r+a],t,a),h===C&&(h=this._$AH[a]),s||=!U(h)||h!==this._$AH[a],h===f?e=f:e!==f&&(e+=(h??"")+n[a+1]),this._$AH[a]=h}s&&!o&&this.j(e)}j(e){e===f?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}},oe=class extends P{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===f?void 0:e}},ie=class extends P{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==f)}},ne=class extends P{constructor(e,t,r,o,n){super(e,t,r,o,n),this.type=5}_$AI(e,t=this){if((e=O(this,e,t,0)??f)===C)return;let r=this._$AH,o=e===f&&r!==f||e.capture!==r.capture||e.once!==r.once||e.passive!==r.passive,n=e!==f&&(r===f||o);o&&this.element.removeEventListener(this.name,this,r),n&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){typeof this._$AH=="function"?this._$AH.call(this.options?.host??this.element,e):this._$AH.handleEvent(e)}},se=class{constructor(e,t,r){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(e){O(this,e)}};var Je=ae.litHtmlPolyfillSupport;Je?.(L,I),(ae.litHtmlVersions??=[]).push("3.2.1");var Ae=(i,e,t)=>{let r=t?.renderBefore??e,o=r._$litPart$;if(o===void 0){let n=t?.renderBefore??null;r._$litPart$=o=new I(e.insertBefore(M(),n),n,void 0,t??{})}return o._$AI(i),o};var p=class extends _{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){let e=super.createRenderRoot();return this.renderOptions.renderBefore??=e.firstChild,e}update(e){let t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=Ae(t,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return C}};p._$litElement$=!0,p.finalized=!0,globalThis.litElementHydrateSupport?.({LitElement:p});var Ze=globalThis.litElementPolyfillSupport;Ze?.({LitElement:p});(globalThis.litElementVersions??=[]).push("4.1.1");var y=i=>(e,t)=>{t!==void 0?t.addInitializer(()=>{customElements.define(i,e)}):customElements.define(i,e)};var Xe={attribute:!0,type:String,converter:T,reflect:!1,hasChanged:F},Qe=(i=Xe,e,t)=>{let{kind:r,metadata:o}=t,n=globalThis.litPropertyMetadata.get(o);if(n===void 0&&globalThis.litPropertyMetadata.set(o,n=new Map),n.set(t.name,i),r==="accessor"){let{name:s}=t;return{set(c){let a=e.get.call(this);e.set.call(this,c),this.requestUpdate(s,a,i)},init(c){return c!==void 0&&this.P(s,void 0,i),c}}}if(r==="setter"){let{name:s}=t;return function(c){let a=this[s];e.call(this,c),this.requestUpdate(s,a,i)}}throw Error("Unsupported decorator location: "+r)};function v(i){return(e,t)=>typeof t=="object"?Qe(i,e,t):((r,o,n)=>{let s=o.hasOwnProperty(n);return o.constructor.createProperty(n,s?{...r,wrapped:!0}:r),s?Object.getOwnPropertyDescriptor(o,n):void 0})(i,e,t)}function Ee(i){return v({...i,state:!0,attribute:!1})}function Ce(i){let e=navigator.language||"en";return new Intl.DisplayNames([e],{type:"language"}).of(i)||i}async function Ye(){try{if(!navigator.permissions){(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach(t=>t.stop()),console.log("Microphone permission requested (via fallback).");return}let i=await navigator.permissions.query({name:"microphone"});i.state==="prompt"?((await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach(t=>t.stop()),console.log("Microphone permission requested.")):i.state==="denied"&&console.warn("Microphone permission is denied.")}catch(i){console.error("Error checking/requesting microphone permission:",i)}}async function ke(){if(!navigator.mediaDevices?.enumerateDevices)return console.error("Media devices API not supported."),{devices:[]};await Ye();try{let e=(await navigator.mediaDevices.enumerateDevices()).filter(r=>r.kind==="audioinput"),t=e.length>0?e[0].deviceId:void 0;return{devices:e,defaultDeviceId:t}}catch(i){return console.error("Error enumerating devices:",i),{devices:[]}}}var K=class{constructor(e){this.audioContext=new AudioContext;let t=this.audioContext.createMediaStreamSource(e);this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=8192,t.connect(this.analyser)}getAudioLevel(){let e=this.analyser.fftSize,t=new Uint8Array(e);this.analyser.getByteTimeDomainData(t);let r=0;for(let o=0;o<e;o++){let n=(t[o]-128)/128;r+=n*n}return Math.sqrt(r/e)}};var J=class extends EventTarget{constructor(e,{dictationConfig:t,serverConfig:r}){super(),this.mediaRecorder=new MediaRecorder(e),this.serverConfig=r,this.dictationConfig=t,this.mediaRecorder.ondataavailable=o=>{this.webSocket?.readyState===WebSocket.OPEN&&this.webSocket.send(o.data)}}startRecording(){let e=`wss://api.${this.serverConfig.environment}.corti.app/audio-bridge/v2/transcribe?tenant-name=${this.serverConfig.tenant}&token=Bearer%20${this.serverConfig.token}`;this.webSocket=new WebSocket(e),this.webSocket.onopen=()=>{this.webSocket.send(JSON.stringify({type:"config",configuration:this.dictationConfig}))},this.webSocket.onmessage=t=>{let r=JSON.parse(t.data);r.type==="config"?this.mediaRecorder.start(250):r.type==="transcript"&&this.dispatchEvent(new CustomEvent("transcript",{detail:r,bubbles:!0,composed:!0}))}}async stopRecording(){let e;this.mediaRecorder.stop(),this.webSocket?.readyState===WebSocket.OPEN&&this.webSocket.send(JSON.stringify({type:"end"})),this.webSocket.onmessage=t=>{},this.webSocket.onclose=async()=>{this.webSocket.close(),clearTimeout(e),await new Promise(t=>setTimeout(t,100))},e=setTimeout(()=>{this.webSocket?.readyState===WebSocket.OPEN&&this.webSocket.close()},1e4)}};var Z=class extends EventTarget{constructor(){super(...arguments),this.devices=[],this.selectedDevice="",this.recordingState="stopped",this._mediaStream=null,this._audioService=null,this._dictationService=null}async initialize(){let e=await ke();return this.devices=e.devices,this.selectedDevice=e.defaultDeviceId||"",e}async startRecording(e){this._updateRecordingState("initializing");try{this._mediaStream=await navigator.mediaDevices.getUserMedia({audio:{deviceId:this.selectedDevice}}),this._audioService=new K(this._mediaStream),this._dictationService=new J(this._mediaStream,e),this._dictationService.addEventListener("audio-packet",t=>this.dispatchEvent(new CustomEvent("audio-packet",{detail:t.detail,bubbles:!0,composed:!0}))),this._dictationService.addEventListener("transcript",t=>this.dispatchEvent(new CustomEvent("transcript",{detail:t.detail,bubbles:!0,composed:!0})))}catch(t){console.error("Error getting user media:",t),this._updateRecordingState("stopped");return}this._dictationService?.startRecording(),this._updateRecordingState("recording"),this._visualiserInterval=window.setInterval(()=>{let t=this._audioService?this._audioService.getAudioLevel()*3:0;this.dispatchEvent(new CustomEvent("audio-level-changed",{detail:{audioLevel:t},bubbles:!0,composed:!0}))},150)}async stopRecording(){this._updateRecordingState("stopping"),this._visualiserInterval&&(clearInterval(this._visualiserInterval),this._visualiserInterval=void 0),this._mediaStream&&(this._mediaStream.getTracks().forEach(e=>e.stop()),this._mediaStream=null),await this._dictationService?.stopRecording(),this._updateRecordingState("stopped")}_updateRecordingState(e){this.recordingState=e,this.dispatchEvent(new CustomEvent("recording-state-changed",{detail:{state:e},bubbles:!0,composed:!0}))}};var et=g`
  /* Default (plain) button styling */
  button,
  .button {
    background: var(--action-plain-background);
    /* border: 1px solid var(--action-plain-border-color); */
    border: none;
    color: var(--component-text-color);
    cursor: pointer;
    padding: 8px;
    border-radius: var(--card-inner-border-radius);
    display: inline-flex;
    gap: 4px;
    align-items: center;
    justify-content: center;
    transition: background 0.3s ease;
    font-family: var(--component-font-family);
  }

  button:hover,
  .button:hover {
    background: var(--action-plain-background-hover);
  }

  button:focus-visible {
    outline: 2px solid var(--action-accent-background);
    outline-offset: 2px;
  }

  /* Accent variant */
  button.accent,
  .button.accent {
    background: var(--action-accent-background);
    color: var(--action-accent-text-color);
    border: none;
  }

  button.accent:hover,
  .button.accent:hover {
    background: var(--action-accent-background-hover);
  }

  /* Accent variant */
  button.red,
  .button.red {
    background: var(--action-red-background);
    color: var(--action-red-text-color);
    border: none;
  }

  button.red:hover,
  .button.red:hover {
    background: var(--action-red-background-hover);
  }
`,X=et;var tt=g`
  label {
    display: block;
    font-size: 0.8rem;
    padding-bottom: 0.5rem;
    font-weight: 500;
    color: var(--component-text-color);
    pointer-events: none;
  }
  select {
    background: var(--card-background);
    color: var(--component-text-color);
    border: 1px solid var(--card-border-color);
    padding: var(--card-padding);
    border-radius: var(--card-inner-border-radius);
    outline: none;
    width: 100%;
  }

  select:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  select:hover {
    background: var(--action-plain-background-hover);
  }

  select:focus-visible {
    outline: 2px solid var(--action-accent-background);
    /* outline-offset: 2px; */
  }
`,Oe=tt;var Pe=["en","da"],Re={primaryLanguage:"en",interimResults:!0,spokenPunctuation:!0,automaticPunctuation:!0,model:"others"};var rt=g`
  .callout {
    background: var(--callout-accent-background);
    border: 1px solid var(--callout-accent-border);
    color: var(--callout-accent-text);
    padding: 8px;
    border-radius: var(--card-inner-border-radius);
    display: flex;
    font-size: 0.9rem;
    gap: 8px;
    align-items: flex-start;
    &.red {
      background: var(--callout-red-background);
      border: 1px solid var(--callout-red-border);
      color: var(--callout-red-text);
    }
    &.orange {
      background: var(--callout-orange-background);
      border: 1px solid var(--callout-orange-border);
      color: var(--callout-orange-text);
    }
  }
`,Q=rt;var k=class extends p{constructor(){super(...arguments),this.devices=[],this.selectedDevice="",this.selectedLanguage="",this.settingsDisabled=!1}_selectDevice(e){this.selectedDevice=e;let t=this.devices.find(r=>r.deviceId===e);this.dispatchEvent(new CustomEvent("recording-device-changed",{detail:t,bubbles:!0,composed:!0}))}render(){return u`
      <div class="mic-selector">
        <button id="settings-popover-button" popovertarget="settings-popover">
          <icon-settings></icon-settings>
        </button>
        <div id="settings-popover" popover>
          <div class="settings-wrapper">
          ${this.settingsDisabled?u`
                  <div class="callout orange">
                      Recording is in progress. Stop recording to change settings.
                    
                  </div>
                `:""}
          <div class="form-group">
            <label id="device-select-label" for="device-select">
              Recording Device
            </label>
            <select
              id="device-select"
              aria-labelledby="device-select-label"
              @change=${e=>{this._selectDevice(e.target.value)}}
              ?disabled=${this.settingsDisabled}
            >
              ${this.devices.map(e=>u`
                  <option
                    value=${e.deviceId}
                    ?selected=${this.selectedDevice===e.deviceId}
                  >
                    ${e.label||"Unknown Device"}
                  </option>
                `)}
            </select>
          </div>
          <div class="form-group">
            <label id="language-select-label" for="language-select">
              Dictation Language
            </label>
            <select
              id="language-select"
              aria-labelledby="language-select-label"
              @change=${e=>{this._selectDevice(e.target.value)}}
              ?disabled=${this.settingsDisabled}
            >
              ${Pe.map(e=>u`
                  <option
                    value=${e}
                    ?selected=${this.selectedLanguage===e}
                  >
                    ${Ce(e)}
                  </option>
                `)}
            </select>
          </div>
          </div>
        </div>
      </div>
    `}};k.styles=[g`
      :host {
        display: block;
        font-family: var(--component-font-family);
      }
      /* Retain the anchor-name styling for this component */
      #settings-popover-button {
        anchor-name: --settings_popover_btn;
      }
      [popover] {
        margin: 0;
        padding: 16px;
        border: 0;
        background: var(--card-background);
        border: 1px solid var(--card-border-color);
        border-radius: var(--card-border-radius);
        box-shadow: var(--card-box-shadow);
        z-index: 1000;
        max-width: 260px;
        width: 100%;
        min-width: 200px;
        position-anchor: --settings_popover_btn;
        position-area: bottom;
        position-visibility: always;
        /* inset: unset; */
        transform: translateX(40%);
        overflow-x: hidden;
      }
      .settings-wrapper {
        display: flex;
        flex-direction: column;
        gap: 20px;
      }
    `,X,Oe,Q];d([v({type:Array})],k.prototype,"devices",void 0);d([v({type:String})],k.prototype,"selectedDevice",void 0);d([v({type:String})],k.prototype,"selectedLanguage",void 0);d([v({type:Boolean})],k.prototype,"settingsDisabled",void 0);k=d([y("settings-menu")],k);var N=class extends p{constructor(){super(...arguments),this.level=0,this.active=!0}render(){let e=Math.round(this.level*5),t=[];for(let r=0;r<5;r++)t.push(u`
        <div class="segment ${r<e?"active":""}"></div>
      `);return u`
      <div class="container ${this.active?"active":""}">
        ${t}
      </div>
    `}};N.styles=g`
  :host {
    height: 100%;
  }
    .container {
      display: flex;
      width: 8px;
      flex-direction: column-reverse; /* Bottom-up stacking */
      height: 100%;
      gap: 1px;
      opacity: 0.5;
      &.active {
       opacity: 1 
      }
    }
    .segment {
      flex: 1;
      background-color: var(--action-accent-text-color);
      transition: background-color 0.25s;
      border-radius: 1px;
      opacity: 0.5;
    }
    .segment.active {
      opacity: 1;
    }
  `;d([v({type:Number})],N.prototype,"level",void 0);d([v({type:Boolean})],N.prototype,"active",void 0);N=d([y("audio-visualiser")],N);var De=class extends p{render(){return u`
      <div style="display: flex">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="20"
          height="20"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="lucide lucide-mic"
        >
          <path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z" />
          <path d="M19 10v2a7 7 0 0 1-14 0v-2" />
          <line x1="12" x2="12" y1="19" y2="22" />
        </svg>
      </div>
    `}};De=d([y("icon-mic-on")],De);var Te=class extends p{render(){return u` <div style="display: flex">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="20"
        height="20"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        class="lucide lucide-mic-off"
      >
        <line x1="2" x2="22" y1="2" y2="22" />
        <path d="M18.89 13.23A7.12 7.12 0 0 0 19 12v-2" />
        <path d="M5 10v2a7 7 0 0 0 12 5" />
        <path d="M15 9.34V5a3 3 0 0 0-5.68-1.33" />
        <path d="M9 9v3a3 3 0 0 0 5.12 2.12" />
        <line x1="12" x2="12" y1="19" y2="22" />
      </svg>
    </div>`}};Te=d([y("icon-mic-off")],Te);var je=class extends p{render(){return u`
      <div style="display: flex;">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="20"
          height="20"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="lucide lucide-circle-stop"
        >
          <circle cx="12" cy="12" r="10" />
          <rect x="9" y="9" width="6" height="6" rx="1" fill="currentColor" />
        </svg>
      </div>
    `}};je=d([y("icon-recording")],je);var Me=class extends p{render(){return u`<div style="display: flex">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="20"
        height="20"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        class="lucide lucide-settings-2"
      >
        <path d="M20 7h-9" />
        <path d="M14 17H5" />
        <circle cx="17" cy="17" r="3" />
        <circle cx="7" cy="7" r="3" />
      </svg>
    </div>`}};Me=d([y("icon-settings")],Me);var de=class extends p{render(){return u`<div style="display: flex">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="20"
        height="20"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        class="lucide lucide-loader-circle spin"
      >
        <path d="M21 12a9 9 0 1 1-6.219-8.56" />
      </svg>
    </div>`}};de.styles=g`
    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }
      100% {
        transform: rotate(360deg);
      }
    }
    .spin {
      animation: spin 1s linear infinite;
    }
  `;de=d([y("icon-loading-spinner")],de);var ot=g`
  :host {
    /* Component Defaults */
    --component-font-family: 'Segoe UI', Roboto, sans-serif;
    --component-text-color: #333;
    
    /* Card Defaults */
    --card-background: #fff;
    --card-border-color: #ddd;
    --card-padding: 4px;
    --card-border-radius: 8px;
    --card-inner-border-radius: 6px;
    --card-box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    
    /* Actions Defaults */
    --action-plain-border-color: #ccc;
    --action-plain-background-hover: #ddd;

    --action-accent-background: #007bff;
    --action-accent-background-hover: #0056b3;
    --action-accent-text-color: #fff;

    --action-red-background: #dc3545;
    --action-red-background-hover: #bd2130;
    --action-red-text-color: #fff;

    /* Callout Defaults */
    --callout-accent-background: #007bff33;
    --callout-accent-border: #007bff99;
    --callout-accent-text: #007bff;

    --callout-red-background: #dc354533;
    --callout-red-border: #dc354599;
    --callout-red-text: #dc3545;

    --callout-orange-background: #fd7e1433;
    --callout-orange-border: #fd7e1499;
    --callout-orange-text: #fd7e14;


    /* Visualiser Defaults */
    --visualiser-background: #e0e0e0;
    --visualiser-level-color: #28a745;
  }

  @media (prefers-color-scheme: dark) {
    :host {
       /* Component Dark */
      --component-text-color: #eee;

      /* Card Dark */
      --card-background: #333;
      --card-border-color: #555;

      /* Actions Dark */
      --action-plain-border-color: #555;
      --action-plain-background: #333;
      --action-plain-background-hover: #444;

      --action-accent-background: #0056b3;
      --action-accent-background-hover: #003d80;

      /* Visualiser Dark */
      --visualiser-background: #fff;
    }
  }
  :host {
    box-sizing: border-box;
    font-family: var(--component-font-family);
    color: var(--component-text-color);
  }
`,Ue=ot;var it=g`
 .wrapper {
      background-color: var(--card-background);
      border: 1px solid var(--card-border-color);
      border-radius: var(--card-border-radius);
      box-shadow: var(--card-box-shadow);
      padding: var(--card-padding);
      display: flex;
      width: min-content;
      gap: 4px;
      height: 46px;
      box-sizing: border-box;
      overflow: hidden;
    }
    h2 {
      margin: 0 0 10px;
      font-size: 1rem;
      font-weight: 500;
    }
    label {
      font-size: 0.9rem;
      margin-right: 8px;
    }
    select {
      padding: 4px 6px;
      font-size: 0.9rem;
      border: 1px solid var(--card-border-color);
      border-radius: 4px;
      background-color: var(--card-background);
      color: inherit;
    }

    .visualiser {
      width: 16px;
      height: 100%;
      background: var(--visualiser-background);
      margin-top: 8px;
      border-radius: 5px;
      overflow: hidden;
      display: flex;
      align-items: flex-end;
    }
    .level {
      height: 100%;
      width: 100%;
      background: var(--visualiser-level-color);
      transition: width 0.1s ease-in-out;
    }
`,Le=it;var x=class extends p{constructor(){super(...arguments),this.devices=[],this.recordingState="stopped",this.dictationConfig=Re,this.serverConfig={},this._audioLevel=0,this.recorderManager=new Z}async connectedCallback(){super.connectedCallback(),await this.recorderManager.initialize(),this.devices=this.recorderManager.devices;let e={"recording-state-changed":r=>{this.recordingState=r.detail.state},"audio-level-changed":r=>{this._audioLevel=r.detail.audioLevel,this.requestUpdate()}};["recording-state-changed","audio-level-changed","audio-packet","transcript"].forEach(r=>{this.recorderManager.addEventListener(r,o=>{let n=o;e[r]&&e[r](n),this.dispatchEvent(new CustomEvent(r,{detail:n.detail,bubbles:!0,composed:!0}))})})}toggleRecording(){this._toggleRecording()}_toggleRecording(){this.recordingState==="recording"?this.recorderManager.stopRecording():this.recordingState==="stopped"&&this.recorderManager.startRecording({dictationConfig:this.dictationConfig,serverConfig:this.serverConfig})}async _onRecordingDeviceChanged(e){let t=e;this.recorderManager.selectedDevice=t.detail.deviceId,this.recordingState==="recording"&&(await this.recorderManager.stopRecording(),await this.recorderManager.startRecording({dictationConfig:this.dictationConfig,serverConfig:this.serverConfig}))}render(){if(!(this.serverConfig&&this.serverConfig.token&&this.serverConfig.environment&&this.serverConfig.tenant))return u`
        <div class="wrapper">
          <div class="callout red tiny">
            Please configure the server settings in the parent component.
          </div>
        </div>
      `;let t=this.recordingState==="initializing"||this.recordingState==="stopping",r=this.recordingState==="recording";return u`
      <div class="wrapper">
        <button
          @click=${this._toggleRecording}
          class=${r?"red":"accent"}
        >
          ${t?u`<icon-loading-spinner></icon-loading-spinner>`:r?u`<icon-recording></icon-recording>`:u`<icon-mic-on></icon-mic-on>`}
          <audio-visualiser
            .level=${this._audioLevel}
            .active=${r}
          ></audio-visualiser>
        </button>
  
        <settings-menu
          .devices=${this.devices}
          .selectedDevice=${this.recorderManager.selectedDevice}
          ?settingsDisabled=${this.recordingState!=="stopped"}
          @recording-device-changed=${this._onRecordingDeviceChanged}
        ></settings-menu>
      </div>
    `}};x.styles=[X,Ue,Le,Q];d([v({type:Array})],x.prototype,"devices",void 0);d([v({type:String,reflect:!0})],x.prototype,"recordingState",void 0);d([v({type:Object})],x.prototype,"dictationConfig",void 0);d([v({type:Object})],x.prototype,"serverConfig",void 0);d([Ee()],x.prototype,"_audioLevel",void 0);var ro=x;export{x as CortiDictation,ro as default};
/*! Bundled license information:

@lit/reactive-element/css-tag.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   *)

@lit/reactive-element/reactive-element.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   *)

lit-html/lit-html.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   *)

lit-element/lit-element.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   *)

lit-html/is-server.js:
  (**
   * @license
   * Copyright 2022 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   *)

@lit/reactive-element/decorators/custom-element.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   *)

@lit/reactive-element/decorators/property.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   *)

@lit/reactive-element/decorators/state.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   *)

@lit/reactive-element/decorators/event-options.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   *)

@lit/reactive-element/decorators/base.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   *)

@lit/reactive-element/decorators/query.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   *)

@lit/reactive-element/decorators/query-all.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   *)

@lit/reactive-element/decorators/query-async.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   *)

@lit/reactive-element/decorators/query-assigned-elements.js:
  (**
   * @license
   * Copyright 2021 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   *)

@lit/reactive-element/decorators/query-assigned-nodes.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   *)
*/
